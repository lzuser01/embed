<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Reproductor Plyr Encriptado</title>

<!-- Plyr CSS -->
<link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />

<style>
  body, html {
    margin: 0; padding: 0; height: 100%; background: #000; display: flex; justify-content: center; align-items: center;
  }
  #player-container {
    width: 90vw;
    max-width: 900px;
  }
  .plyr__controls {
    background: rgba(0, 0, 0, 0.7) !important;
  }
  /* Botones personalizados */
  #custom-controls {
    margin-top: 10px;
    display: flex;
    justify-content: center;
    gap: 20px;
  }
  #custom-controls button {
    background: #ffcc00;
    border: none;
    color: #000;
    font-weight: bold;
    font-size: 1rem;
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.3s ease;
  }
  #custom-controls button:hover {
    background: #e6b800;
  }
</style>
</head>
<body>

<div id="player-container">
  <video id="player" playsinline controls crossorigin></video>

  <div id="custom-controls">
    <button id="rewindBtn" aria-label="Retroceder 10 segundos">⏪ 10s</button>
    <button id="forwardBtn" aria-label="Adelantar 10 segundos">10s ⏩</button>
  </div>
</div>

<!-- Plyr JS -->
<script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>

<script>
  // Obtener parámetro 'video' en base64 y decodificar
  function obtenerParametro(nombre) {
    var params = new URLSearchParams(window.location.search);
    return params.get(nombre);
  }

  const base64video = obtenerParametro('video');
  if (!base64video) {
    alert('No se encontró el parámetro de video.');
  }

  let videoUrl = '';
  try {
    videoUrl = atob(base64video);
  } catch {
    alert('Error al decodificar la URL del video.');
  }

  const video = document.getElementById('player');
  video.src = videoUrl;

  // Inicializar Plyr
  const player = new Plyr(video, {
    controls: [
      'play-large', 'play', 'progress', 'current-time', 'duration', 'mute', 'volume', 'fullscreen'
    ]
  });

  // Botones personalizados
  const rewindBtn = document.getElementById('rewindBtn');
  const forwardBtn = document.getElementById('forwardBtn');

  rewindBtn.addEventListener('click', () => {
    player.currentTime = Math.max(player.currentTime - 10, 0);
  });

  forwardBtn.addEventListener('click', () => {
    player.currentTime = Math.min(player.currentTime + 10, player.duration);
  });
</script>
</body>
</html>
